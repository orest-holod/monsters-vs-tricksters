function FacebookShare(e){function t(t){"connected"===t.status?i(e):"not_authorized"===t.status?FB.login(function(t){i(e)}):FB.login(function(t){i(e)})}function i(e){FB.ui({method:"feed",link:"http://orest-o-holod.github.io/monsters-vs-tricksters/",picture:"https://pp.vk.me/c629405/v629405403/3f301/iP02mTEe4lk.jpg",name:"Monsters-VS-Tricksters",description:"I scored: "+e+" points in a game monsters-vs-tricksters. Betcha can't score more point!",caption:"Monsters-VS-Tricksters - pure Javascript DOM based game"},function(e){e&&!e.error_message?alert("Posting completed."):alert("Error while posting.")})}window.fbAsyncInit=function(){FB.init({appId:"451460438391465",cookie:!0,xfbml:!0,version:"v2.5"}),FB.getLoginStatus(function(e){t(e)})},function(e,t,i){var s,n=e.getElementsByTagName(t)[0];e.getElementById(i)||(s=e.createElement(t),s.id=i,s.src="//connect.facebook.net/en_US/sdk.js",n.parentNode.insertBefore(s,n))}(document,"script","facebook-jssdk")}function AnimationFrameManager(e){this._animationFrameId=0,this._now=Date.now(),this._then=this._now,this._delta=0,this._second=0,this._animationFrameCounter=0,this._currentFPS=0,this._wantedFPS=e||60}function ConnectComputer(){var e,t="wss://powerful-anchorage-61180.herokuapp.com",i=new WebSocket(t);i.onopen=function(){console.log("connected!"),e=prompt("Please enter pin code for your game (for remote contol)")},i.onclose=function(e){console.log("closed"+e.code)},i.onmessage=function(t){try{var s=JSON.parse(t.data);if(e==s.pinCode)if(s.firstConnect&&!game.getGamer().getID())game.getGamer().setID(s.gamerID),game._gameField.getGameFieldBackground().getGameFieldBackgroundRemoteLayer().setTextContent("Remote control ON<br/>PIN to access: "+e);else if(game.getGamer().getID()==s.gamerID)if(s.keyDownEvent)game.keyDownEventHandler(s);else if(s.keyUpEvent)game.keyUpEventHandler(s);else if("play-game-menu-item"==s.target.id){game.reset();var n={gamerID:s.gamerID,pinCode:s.pinCode,newGame:!0};i.send(JSON.stringify(n))}console.log(s)}catch(a){}}}function Game(e){var t=this;this._parentDOMElement=e,this._animationFrameManager=new AnimationFrameManager(gameConfigs.fps),this._gameField=new GameField(t._parentDOMElement,!0),this._gameFieldTower=this._gameField.getGameFieldTower(),this._gameFieldMenu=this._gameField.getGameFieldMenu(),this._gameFieldTouch=this._gameField.getGameFieldTouch(),this._gamer=new Gamer(t._gameField),this.soundManager=new SoundManager(e),this.soundManager.getBackgroundSound().loop=!0,this.soundManager.getBackgroundSound().play(),this._isTouchDevice=!1,this._isFirstTouch=!0,this._isMusicOn=!0,this._isSoundOn=!0,this._isEscPressed=!1,this._isRightKeyPressed=!1,this._isLeftKeyPressed=!1,this._isUpKeyPressed=!1,this._isDownKeyPressed=!1,this._isSpaceKeyPressed=!1,this._isSpaceKeyUp=!0,this._isGameOver=!1,this._isGameStop=!1}function GameEntity(e,t,i,s,n,a){if(this._DOMElement=document.createElement(e),this._parentDOMElement=t,this._appendedToParentDOMElement=!1,this._parentDOMElement&&i&&(this._parentDOMElement.appendChild(this._DOMElement),this._appendedToParentDOMElement=!0),this._DOMElement.className="game-entity",s&&(this._DOMElement.id=s),n){var r=this;n.forEach(function(e){r._DOMElement.classList.add(e)})}a&&(this._DOMElement.innerHTML=a),this._cr=this._DOMElement.getBoundingClientRect(),this._x=this._cr.left,this._y=this._cr.bottom,this._width=this._cr.width,this._height=this._cr.height,this._dx=0,this._dy=0,this._angle=0,this._dAngle=0,this._color="",this._boxShadow="",this._translateX=0,this._translateY=0,this._display="block",this._visibility="visible",this._textContent="",this._scale=1,this._dScale=0,this._smthChanged=!1,this._needRepaint={x:!1,y:!1,angle:!1,width:!1,height:!1,color:!1,boxShadow:!1,translateX:!1,translateY:!1,display:!1,visibility:!1,textContent:!1,scale:!1}}function GameField(e,t){GameEntity.call(this,"div",e,t,"game-field",["game-field"]),this._gameFieldBackground=new GameFieldBackground(this._DOMElement,!0),this._gameFieldTower=new GameFieldTower(this._DOMElement,!0),this._gameFieldMenu=new GameFieldMenu(this._DOMElement,!0),this._gameFieldTouch=new GameFieldTouch(this._DOMElement,!0),this._gameFieldScore=new GameFieldScore(this._DOMElement,!0)}function GameFieldBackground(e,t){GameEntity.call(this,"div",e,t,"game-field-background",["game-field"]),this._gameFieldBackgroundSkyLayer=new GameFieldLayer(this._DOMElement,!0,"game-field-background-sky-layer"),this._gameFieldBackgroundStarsLayer=new GameFieldLayer(this._DOMElement,!0,"game-field-background-stars-layer"),this._gameFieldBackgroundCloudsLayer=new GameFieldLayer(this._DOMElement,!0,"game-field-background-clouds-layer"),this._gameFieldBackgroundTowerLayer=new GameFieldLayer(this._DOMElement,!0,"game-field-background-tower-layer"),this._gameFieldBackgroundFPSLayer=new GameFieldLayer(this._DOMElement,!0,"game-field-background-fps-layer"),this._gameFieldBackgroundRemoteLayer=new GameFieldLayer(this._DOMElement,!0,"game-field-background-remote-layer"),this._gameFieldBackgroundRemoteLayer.setTextContent("Remote control OFF"),this._gameFieldBackgroundStarsLayer.setDX(gameConfigs.gameField.gameFieldBackground.gameFieldBackgroundStarsLayer.dx),this._gameFieldBackgroundStarsLayer.setDY(gameConfigs.gameField.gameFieldBackground.gameFieldBackgroundStarsLayer.dy),0!==this._gameFieldBackgroundStarsLayer.getDX()&&(this._gameFieldBackgroundStarsLayer.setWidth(5*this.getWidth()),this._gameFieldBackgroundStarsLayer.getDX()>0&&this._gameFieldBackgroundStarsLayer.setTranslateX(-this._gameFieldBackgroundStarsLayer.getWidth()+this.getWidth())),0!==this._gameFieldBackgroundStarsLayer.getDY()&&(this._gameFieldBackgroundStarsLayer.setHeight(5*this.getHeight()),this._gameFieldBackgroundStarsLayer.getDY()>0&&this._gameFieldBackgroundStarsLayer.setTranslateY(-this._gameFieldBackgroundStarsLayer.getHeight()+this.getHeight())),this._gameFieldBackgroundCloudsLayer.setDX(gameConfigs.gameField.gameFieldBackground.gameFieldBackgroundCloudsLayer.dx),this._gameFieldBackgroundCloudsLayer.setDY(gameConfigs.gameField.gameFieldBackground.gameFieldBackgroundCloudsLayer.dy),0!==this._gameFieldBackgroundCloudsLayer.getDX()&&(this._gameFieldBackgroundCloudsLayer.setWidth(5*this.getWidth()),this._gameFieldBackgroundCloudsLayer.getDX()>0&&this._gameFieldBackgroundCloudsLayer.setTranslateX(-this._gameFieldBackgroundCloudsLayer.getWidth()+this.getWidth())),0!==this._gameFieldBackgroundCloudsLayer.getDY()&&(this._gameFieldBackgroundCloudsLayer.setHeight(5*this.getHeight()),this._gameFieldBackgroundCloudsLayer.getDY()>0&&this._gameFieldBackgroundCloudsLayer.setTranslateY(-this._gameFieldBackgroundCloudsLayer.getHeight()+this.getHeight()))}function GameFieldLayer(e,t,i){GameEntity.call(this,"div",e,t,i,["game-field-layer"])}function GameFieldMenu(e,t){GameEntity.call(this,"div",e,t,"game-field-menu",["game-field"]);var i="Gamer (main monster) jumps up an infinite tower looking and trying to resque his friends (other monsters) that have been kidnapped and now being under the spell of evil tricksters. Evil tricksters do their best to keep monster from resquing his friends...";this._menuHeader=new GameFieldMenuHeader(this.getDOMElement(),"Monsters<br/>vs<br/>Tricksters"),this._menuGameOver=new GameFieldMenuGameInfo(this.getDOMElement(),"menu-game-over","Game Over"),this._menuGamePaused=new GameFieldMenuGameInfo(this.getDOMElement(),"menu-game-paused","Game Paused"),this._menuAboutGame=new GameFieldMenuText(this.getDOMElement(),"menu-game-about-text",i),this._menuItems=[];var s=new GameFieldMenuItem(this.getDOMElement(),"play-game-menu-item","New Game"),n=new GameFieldMenuItem(this.getDOMElement(),"resume-game-menu-item","Resume Game"),a=new GameFieldMenuItem(this.getDOMElement(),"music-on-off-menu-item","Music OFF"),r=new GameFieldMenuItem(this.getDOMElement(),"sound-on-off-menu-item","Sound OFF"),o=new GameFieldMenuItem(this.getDOMElement(),"facebook-menu-item","FB"),m=new GameFieldMenuItem(this.getDOMElement(),"about-menu-item","About"),h=new GameFieldMenuItem(this.getDOMElement(),"connect-menu-item","Connect Computer"),d=new GameFieldMenuItem(this.getDOMElement(),"remote-control-menu-item","Remote control"),g=new GameFieldMenuItem(this.getDOMElement(),"back-to-menu-menu-item","Go back to menu");this._menuItems.push(s),this._menuItems.push(n),this._menuItems.push(a),this._menuItems.push(r),this._menuItems.push(o),this._menuItems.push(m),this._menuItems.push(h),this._menuItems.push(d),this._menuItems.push(g),this._menuGameOver.makeHidden(),this._menuGamePaused.makeHidden(),this._menuAboutGame.makeHidden(),this._menuItems[8].makeHidden(),this.makeHidden()}function GameFieldMenuItem(e,t,i){GameEntity.call(this,"div",e,!0,t,["game-field-menu-item"],i)}function GameFieldMenuHeader(e,t){GameEntity.call(this,"h1",e,!0,"menu-header",["game-field-menu-header"],t)}function GameFieldMenuGameInfo(e,t,i){GameEntity.call(this,"h2",e,!0,t,["game-field-menu-header"],i)}function GameFieldMenuText(e,t,i){GameEntity.call(this,"div",e,!0,t,["game-field-menu-text"],i)}function GameFieldScore(e,t){GameEntity.call(this,"div",e,t,"game-field-score",["game-field"]),this._lifes=gameConfigs.gameField.gameFieldScore.lifes,this._gameFieldScoreLifes=new GameEntity("div",this.getDOMElement(),!0,"game-field-score-lifes",[]),this._gameFieldScoreLifesItems=[];for(var i=0;i<this._lifes;i++)this._gameFieldScoreLifesItems.push(new GameEntity("div",this._gameFieldScoreLifes.getDOMElement(),!0,"",["game-field-score-item","game-field-score-lifes"]));this._gameFieldScoreMonsters=new GameEntity("div",this.getDOMElement(),!0,"game-field-score-monsters",["game-field-score-item"]),this._monsters=0,this._gameFieldScoreMonsters.setTextContent("F "+this._monsters)}function GameFieldTouch(e,t){GameEntity.call(this,"div",e,t,"game-field-touch",["game-field"]),this._gameFieldTouchLeft=new GameEntity("div",this.getDOMElement(),!0,"game-field-touch-left",["game-field-touch-item"]),this._gameFieldTouchSpace=new GameEntity("div",this.getDOMElement(),!0,"game-field-touch-space",["game-field-touch-item"]),this._gameFieldTouchRight=new GameEntity("div",this.getDOMElement(),!0,"game-field-touch-right",["game-field-touch-item"])}function GameFieldTower(e,t){GameEntity.call(this,"div",e,t,"game-field-tower",["game-field"]),this._pixel=0,this._maxX=this.getWidth(),this._maxY=this.getHeight(),this._widthX=Math.floor(this._maxX/5),this._heightY=gameConfigs.gameField.gameFieldTower.steps.heightOfLevel,this._steps=[],this._tricksters=[],this._monsters=[],this._lifes=[],this._visibleSteps=[],this._visibleTricksters=[],this._visibleMonsters=[],this._visibleLifes=[],this._steps=this.generateSteps(),this._tricksters=this.generateTricksters(this._steps),this._monsters=this.generateMonsters(this._steps),this._lifes=this.generateLifes(this._steps),this.update()}function Gamer(e){GameEntity.call(this,"div",e.getGameFieldTower().getDOMElement(),!0,"gamer",["monster"],"Q"),this._id="",this._gameField=e,this._gameFieldTower=e.getGameFieldTower(),this._targetStep=e.getGameFieldTower().getVisibleSteps()[Math.floor(window.innerHeight/gameConfigs.gameField.gameFieldTower.steps.heightOfLevel)],this.setX(this._targetStep.getX()),this.setY(this._targetStep.getY()+this._targetStep.getHeight()),this.setDX(gameConfigs.gamer.dx),this.setDY(gameConfigs.gamer.dy),this.setDAngle(gameConfigs.gamer.dAngle),this.setDScale(gameConfigs.gamer.dScale),this._ddy=gameConfigs.gamer.ddy,this._isFalling=!1,this._fallingCounter=0,this._nearestTargetBottomStep=null,this._isJumping=!1,this._jumpingCounter=0,this._lastTouchedTrickster=null}function Life(e,t){GameEntity.call(this,"div",e,t,"",["life"]),this._targetStep=null}function Monster(e,t,i,s){GameEntity.call(this,"div",e,t,i,["monster"],s),this._targetStep=null}function SoundManager(e){var t=["sounds/Brave_World_cut.mp3","sounds/game_over.mp3","sounds/2_steps.mp3","sounds/1_jump.mp3","sounds/got _life.mp3","sounds/pop.mp3","sounds/laughter.mp3"];this.backgroundSound=document.createElement("audio"),this.stepSound=document.createElement("audio"),this.jumpSound=document.createElement("audio"),this.gameOverSound=document.createElement("audio"),this.lifeSound=document.createElement("audio"),this.touchedMonsterSound=document.createElement("audio"),this.touchedTricksterSound=document.createElement("audio"),e.appendChild(this.backgroundSound),e.appendChild(this.stepSound),e.appendChild(this.jumpSound),e.appendChild(this.gameOverSound),e.appendChild(this.lifeSound),e.appendChild(this.touchedMonsterSound),e.appendChild(this.touchedTricksterSound),this.getBackgroundSound=function(){return this.backgroundSound.src||(this.backgroundSound.src=t[0]),this.backgroundSound},this.getStepSound=function(){return this.stepSound.src||(this.stepSound.src=t[2]),this.stepSound},this.getJumpSound=function(){return this.jumpSound.src||(this.jumpSound.src=t[3]),this.jumpSound},this.getGameOverSound=function(){return this.gameOverSound.src||(this.gameOverSound.src=t[1]),this.gameOverSound},this.getLifeSound=function(){return this.lifeSound.src||(this.lifeSound.src=t[4]),this.lifeSound},this.getTouchedMonsterSound=function(){return this.touchedMonsterSound.src||(this.touchedMonsterSound.src=t[5]),this.touchedMonsterSound},this.getTouchedTricksterSound=function(){return this.touchedTricksterSound.src||(this.touchedTricksterSound.src=t[6]),this.touchedTricksterSound}}function Step(e,t,i,s,n,a,r){GameEntity.call(this,"div",e,t,"",["step"]),this._levelIndex=s,this._levelHeight=a,this.setBoxShadow("0 0 1rem 1rem "+r),this.setX(i),this.setY(s*a),this.setHeight(5),this.setWidth(n),this._targetMonster=null,this._targetTrickster=null}function Trickster(e,t,i){GameEntity.call(this,"div",e,t,"",["trickster"],i),this._preLevitateX=0,this._preLevitateY=0,this._levitateDX=0,this._levitateDY=0,this._targetStep=null}function debounce(e,t){var i;return function(){var s=this,n=arguments;clearTimeout(i),i=setTimeout(function(){e.apply(s,n)},t)}}AnimationFrameManager.prototype.stop=function(){this._animationFrameId&&cancelAnimationFrame(this._animationFrameId)},AnimationFrameManager.prototype.getCurrentFPS=function(){return this._currentFPS},AnimationFrameManager.prototype.runAtWantedFPS=function(e){var t=this,i=performance.now(),s=1e3/this._wantedFPS;return function n(){t._animationFrameId=requestAnimationFrame(n);var a=performance.now(),r=a-i;r>s&&(i=a-r%s,t._second+=r,t._second>=1e3&&(t._currentFPS=t._animationFrameCounter,t._animationFrameCounter=0,t._second=0),t._animationFrameCounter++,e())}()},AnimationFrameManager.prototype.getFPSIndex=function(){var e=1;return this._currentFPS&&(e=(this._wantedFPS/this._currentFPS).toFixed(2)),e},Game.prototype.keyDownEventHandler=function(e){switch(e.preventDefault&&e.preventDefault(),e.keyCode){case 27:this._isEscPressed||(this._isEscPressed=!0);break;case 38:this._isUpKeyPressed=!0;break;case 40:this._isDownKeyPressed=!0;break;case 39:this._isSoundOn&&this.soundManager.getStepSound().play(),this._isRightKeyPressed=!0;break;case 37:this._isSoundOn&&this.soundManager.getStepSound().play(),this._isLeftKeyPressed=!0;break;case 32:!this._isSpaceKeyPressed&&this._isSpaceKeyUp&&(this._isSoundOn&&this.soundManager.getJumpSound().play(),this._isSpaceKeyPressed=!0,this._isSpaceKeyUp=!1)}},Game.prototype.keyUpEventHandler=function(e){switch(e.preventDefault&&e.preventDefault(),e.keyCode){case 27:this._isEscPressed&&(this._isEscPressed=!1);break;case 38:this._isUpKeyPressed=!1;break;case 40:this._isDownKeyPressed=!1;break;case 39:this._isRightKeyPressed=!1;break;case 37:this._isLeftKeyPressed=!1;break;case 32:this._isSpaceKeyPressed=!1,this._isSpaceKeyUp=!0}},Game.prototype.mouseClickEventHandler=function(e){if(e.preventDefault&&e.preventDefault(),!this._isTouchDevice)switch(e.target.id){case"play-game-menu-item":this.reset();break;case"resume-game-menu-item":this._gameFieldMenu.makeHidden(),this._gameFieldTower.makeVisible(),this._isGameStop=!1;break;case"music-on-off-menu-item":this._isMusicOn?(this.soundManager.getBackgroundSound().pause(),this._isMusicOn=!1,this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().setTextContent("Music ON")):(this.soundManager.getBackgroundSound().play(),this._isMusicOn=!0,this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().setTextContent("Music OFF"));break;case"sound-on-off-menu-item":this._isSoundOn?(this._isSoundOn=!1,this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().setTextContent("Sound ON")):(this._isSoundOn=!0,this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().setTextContent("Sound OFF"));break;case"facebook-menu-item":FacebookShare(this._gameField.getGameFieldScore().getMonsters());break;case"about-menu-item":this._gameFieldMenu.getGameFieldMenuNewGameItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuResumeItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuFacebookItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuAboutGameItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuConnectComputerItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuRemoteControlItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuAboutGameText().makeVisible(),this._gameFieldMenu.getGameFieldMenuBackToMenuItem().makeVisible();break;case"menu-game-about-text":break;case"connect-menu-item":this._gameFieldMenu.getGameFieldMenuConnectComputerItem().makeHidden(),ConnectComputer(),this._gameField.getGameFieldBackground().getGameFieldBackgroundRemoteLayer().setTextContent("Remote control ON");break;case"remote-control-menu-item":window.location="telephonecontrol.html";break;case"back-to-menu-menu-item":this._gameFieldMenu.getGameFieldMenuAboutGameText().makeHidden(),this._gameFieldMenu.getGameFieldMenuBackToMenuItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuNewGameItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuResumeItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuFacebookItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuAboutGameItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuConnectComputerItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuRemoteControlItem().makeVisible();break;default:this._gameFieldMenu.isVisible()?(this._gameFieldMenu.makeHidden(),this._gameFieldTower.makeVisible(),this._isGameStop=!1):(this._gameFieldMenu.makeVisible(),this._gameFieldTower.makeHidden(!0),this._isGameStop=!0)}},Game.prototype.touchStartEventHandler=function(e){switch(e.preventDefault&&e.preventDefault(),this._isFirstTouch&&(this.soundManager.getBackgroundSound().play(),this._isFirstTouch=!1),this._isTouchDevice||(this._isTouchDevice=!0),e.target.id){case"game-field-touch-left":this._isSoundOn&&this.soundManager.getStepSound().play(),this._isLeftKeyPressed=!0;break;case"game-field-touch-right":this._isSoundOn&&this.soundManager.getStepSound().play(),this._isRightKeyPressed=!0;break;case"game-field-touch-space":!this._isSpaceKeyPressed&&this._isSpaceKeyUp&&(this._isSoundOn&&this.soundManager.getJumpSound().play(),this._isSpaceKeyPressed=!0,this._isSpaceKeyUp=!1);break;case"play-game-menu-item":this.reset();break;case"resume-game-menu-item":this._gameFieldMenu.makeHidden(),this._gameFieldTower.makeVisible(),this._gameFieldTouch.makeVisible(),this._isGameStop=!1;break;case"music-on-off-menu-item":this._isMusicOn?(this.soundManager.getBackgroundSound().pause(),this._isMusicOn=!1,this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().setTextContent("Music ON")):(this.soundManager.getBackgroundSound().play(),this._isMusicOn=!0,this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().setTextContent("Music OFF"));break;case"sound-on-off-menu-item":this._isSoundOn?(this._isSoundOn=!1,this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().setTextContent("Sound ON")):(this._isSoundOn=!0,this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().setTextContent("Sound OFF"));break;case"facebook-menu-item":FacebookShare(this._gameField.getGameFieldScore().getMonsters());break;case"about-menu-item":this._gameFieldMenu.getGameFieldMenuNewGameItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuResumeItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuFacebookItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuAboutGameItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuConnectComputerItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuRemoteControlItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuAboutGameText().makeVisible(),this._gameFieldMenu.getGameFieldMenuBackToMenuItem().makeVisible();break;case"connect-menu-item":this._gameFieldMenu.getGameFieldMenuConnectComputerItem().makeHidden(),ConnectComputer();break;case"remote-control-menu-item":window.location="telephonecontrol.html";break;case"back-to-menu-menu-item":this._gameFieldMenu.getGameFieldMenuAboutGameText().makeHidden(),this._gameFieldMenu.getGameFieldMenuBackToMenuItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuNewGameItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuResumeItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuFacebookItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuAboutGameItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuConnectComputerItem().makeVisible(),this._gameFieldMenu.getGameFieldMenuRemoteControlItem().makeVisible();break;case"menu-game-about-text":break;default:this._gameFieldMenu.isVisible()?(this._gameFieldMenu.makeHidden(),this._gameFieldTower.makeVisible(),this._gameFieldTouch.makeVisible(),this._isGameStop=!1):(this._gameFieldMenu.makeVisible(),this._gameFieldTower.makeHidden(!0),this._gameFieldTouch.makeHidden(),this._isGameStop=!0)}},Game.prototype.touchEndEventHandler=function(e){switch(e.preventDefault&&e.preventDefault(),e.target.id){case"game-field-touch-left":this._isLeftKeyPressed=!1;break;case"game-field-touch-right":this._isRightKeyPressed=!1;break;case"game-field-touch-space":this._isSpaceKeyPressed=!1,this._isSpaceKeyUp=!0}},Game.prototype.resizeEventHandler=function(e){var t=this._gameFieldTower,i=this._gameField.getGameFieldBackground(),s=i.getGameFieldBackgroundTowerLayer(),n=i.getGameFieldBackgroundStarsLayer(),a=i.getGameFieldBackgroundCloudsLayer(),r=t.getDOMElement().getBoundingClientRect(),o=s.getDOMElement().getBoundingClientRect(),m=t.getWidth(),h=r.width,d=h/m,g=s.getHeight(),l=o.height,u=l/g;if(1!==d){var c=t.getSteps();c.forEach(function(e){e.setWidth(e.getWidth()*d),e.setX(e.getX()*d);var t=e.getTargetMonster();t&&t.setTargetStep(e);var i=e.getTargetTrickster();i&&i.setTargetStep(e);var s=e.getTargetLife();s&&s.setTargetStep(e)},this),this._gamer.setX(this._gamer.getTargetStep().getX()),t.setWidth(h,!1)}if(1!==u){t.setHeight(t.getPixel()+l),t.update();var p=t.getVisibleSteps()[Math.floor(window.innerHeight/gameConfigs.gameField.gameFieldTower.steps.heightOfLevel)];this._gamer.setTargetStep(p),this._gamer.setX(this._gamer.getTargetStep().getX()),s.setHeight(l,!1)}0!==n.getDX()&&(n.setWidth(5*window.innerWidth),n.getDX()>0&&n.setTranslateX(n.getWidth()+window.innerWidth)),0!==a.getDX()&&(a.setWidth(5*window.innerWidth),a.getDX()>0&&a.setTranslateX(a.getWidth()+window.innerWidth)),0!==n.getDY()&&(n.setHeight(5*window.innerHeight),n.getDY()>0&&n.setTranslateY(-n.getHeight()+window.innerHeight)),0!==a.getDY()&&(a.setHeight(5*window.innerHeight),a.getDY()>0&&a.setTranslateY(-a.getHeight()+window.innerHeight))},Game.prototype.runGameLoop=function(){if(this._isEscPressed&&(this._gameFieldMenu.isVisible()?(this._gameFieldMenu.makeHidden(),this._gameFieldTower.makeVisible(),this._isGameStop=!1):(this._gameFieldMenu.makeVisible(),this._gameFieldTower.makeHidden(!0),this._isGameStop=!0),this._isEscPressed=!1),this._gameField.getGameFieldBackground().getGameFieldBackgroundFPSLayer().setTextContent("{currentFPS}fps".replace("{currentFPS}",this._animationFrameManager.getCurrentFPS())),this._isGameOver||this._isGameStop)this._isGameOver?(this._gameFieldMenu.makeVisible(),this._gameFieldTower.makeHidden(!0),this._gameField.getGameFieldTouch().makeHidden(),this._gameFieldMenu.getGameFieldMenuGameOver().makeVisible(),this._gameFieldMenu.getGameFieldMenuResumeItem().makeHidden(),this._gameFieldMenu.getGameFieldMenuGamePaused().makeHidden()):this._isGameStop&&this._gameFieldMenu.getGameFieldMenuGamePaused().makeVisible();else{this._gamer.getIsFalling()?this._gamer.fall():this._gamer.getIsJumping()?this._gamer.jump():this._isSpaceKeyPressed&&(this._gamer.jump(),this._isSpaceKeyPressed=!1),this._isLeftKeyPressed&&this._gamer.moveLeft(),this._isRightKeyPressed&&this._gamer.moveRight(),this._isLeftKeyPressed||this._isRightKeyPressed||this._gamer.standStill(),this._gamer.getY()<=0&&(this._isSoundOn&&this.soundManager.getGameOverSound().play(),this._isGameOver=!0);var e=this._gamer.getTouchedMonster();e&&(this._isSoundOn&&this.soundManager.getTouchedMonsterSound().play(),this._gameField.getGameFieldScore().addMonsters(),this._gameFieldTower.pickUpMonster(e));var t=this._gamer.getTouchedLife();t&&this._gameField.getGameFieldScore().getLifes()<3&&(this._isSoundOn&&this.soundManager.getLifeSound().play(),this._gameField.getGameFieldScore().addLifes(),this._gameFieldTower.pickUpLife(t));var i=this._gamer.getTouchedTrickster();i&&(this._isSoundOn&&this.soundManager.getTouchedTricksterSound().play(),this._gameField.getGameFieldScore().removeLifes(),this._gameField.getGameFieldScore().getLifes()||(this._isSoundOn&&this.soundManager.getGameOverSound().play(),this._isGameOver=!0)),this._gameFieldTower.getVisibleTricksters().forEach(function(e){e.rotate(),e.levitate(),e.pulse()}),this._gameFieldTower.getVisibleMonsters().forEach(function(e){e.rotate()}),this._gameFieldTower.getVisibleLifes().forEach(function(e){e.pulse()}),this._gamer.pulse()}this._gameField.getGameFieldBackground().getGameFieldBackgroundCloudsLayer().move(),this._gameField.getGameFieldBackground().getGameFieldBackgroundStarsLayer().move(),this._gameField.repaint(),this._gamer.repaint()},Game.prototype.start=function(){this._animationFrameManager.runAtWantedFPS(this.runGameLoop.bind(this))},Game.prototype.reset=function(){this._animationFrameManager.stop(),this._gameField.removeFromParentDOMElement(),this._gameField=new GameField(this._parentDOMElement,!0),this._gameFieldTower=this._gameField.getGameFieldTower(),this._gameFieldMenu=this._gameField.getGameFieldMenu(),this._gameFieldTouch=this._gameField.getGameFieldTouch(),this._gamer=new Gamer(this._gameField),this._isMusicOn?this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().setTextContent("Music OFF"):this._gameFieldMenu.getGameFieldMenuMusicOnOffItem().setTextContent("Music ON"),this._isSoundOn?this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().setTextContent("Sound OFF"):this._gameFieldMenu.getGameFieldMenuSoundOnOffItem().setTextContent("Sound ON"),this._isGameOver=!1,this._isGameStop=!1,this._animationFrameManager.runAtWantedFPS(this.runGameLoop.bind(this))},Game.prototype.getGamer=function(){return this._gamer},Game.prototype.setGamer=function(e){this._gamer=e},Game.prototype.getIsEscPressed=function(){return this._isEscPressed},Game.prototype.setIsEscPressed=function(e){this._isEscPressed=e},Game.prototype.getIsRightKeyPressed=function(){return this._isRightKeyPressed},Game.prototype.setIsRightKeyPressed=function(e){this._isRightKeyPressed=e},Game.prototype.getIsLeftKeyPressed=function(){return this._isLeftKeyPressed},Game.prototype.setIsLeftKeyPressed=function(e){this._isLeftKeyPressed=e},Game.prototype.getIsUpKeyPressed=function(){return this._isUpKeyPressed},Game.prototype.setIsUpKeyPressed=function(e){this._isUpKeyPressed=e},Game.prototype.getIsDownKeyPressed=function(){return this._isDownKeyPressed},Game.prototype.setIsDownKeyPressed=function(e){this._isDownKeyPressed=e},Game.prototype.getIsSpaceKeyPressed=function(){return this._isSpaceKeyPressed},Game.prototype.setIsSpaceKeyPressed=function(e){this._isSpaceKeyPressed=e},Game.prototype.getIsGameOver=function(){return this._isGameOver},Game.prototype.setIsGameOver=function(e){this._isGameOver=e},Game.prototype.getIsGameStop=function(){return this._isGameStop},Game.prototype.setIsGameStop=function(e){this._isGameStop=e};var gameConfigs={fps:10,gameField:{gameFieldBackground:{gameFieldBackgroundStarsLayer:{dx:-1,dy:-1},gameFieldBackgroundCloudsLayer:{dx:3,dy:0}},gameFieldTower:{steps:{numberOfLevels:1e3,heightOfLevel:75},tricksters:{numberOfTricksters:250,dScale:.05,arrayOfDX:[0,5,10,15,20,0,-5,-10,-15,-20],arrayOfDY:[0,5,10,15,20,0,-5,-10,-15,-20],arrayOfDAngle:[0,5,10,15,20,0,-5,-10,-15,-20],arrayOfLevitateDX:[10,40,70,100,130,160,180,210,240,270,300],arrayOfLevitateDY:[10,40,70,100,130,160,180,210,240,270,300]},monsters:{numberOfMonsters:200,arrayOfDAngle:[5,-5]},lifes:{numberOfLifes:42,dScale:.1}},gameFieldScore:{lifes:3}},gamer:{dx:20,dy:35,dAngle:10,ddy:35,dScale:.025},colors:["#e57373","#ef5350","#f44336","#e53935","#d32f2f","#c62828","#b71c1c","#ff8a80","#ff5252","#ff1744","#d50000","#e91e63","#f48fb1","#f06292","#ec407a","#e91e63","#d81b60","#c2185b","#ad1457","#880e4f","#ff80ab","#ff4081","#f50057","#c51162","#9c27b0","#ce93d8","#ba68c8","#ab47bc","#9c27b0","#8e24aa","#7b1fa2","#6a1b9a","#4a148c","#ea80fc","#e040fb","#d500f9","#aa00ff","#673ab7","#b39ddb","#9575cd","#7e57c2","#673ab7","#5e35b1","#512da8","#4527a0","#311b92","#b388ff","#7c4dff","#651fff","#6200ea","#3f51b5","#9fa8da","#7986cb","#5c6bc0","#3f51b5","#3949ab","#303f9f","#283593","#1a237e","#8c9eff","#536dfe","#3d5afe","#304ffe","#2196f3","#90caf9","#64b5f6","#42a5f5","#2196f3","#1e88e5","#1976d2","#1565c0","#0d47a1","#82b1ff","#448aff","#2979ff","#2962ff","#03a9f4","#81d4fa","#4fc3f7","#29b6f6","#03a9f4","#039be5","#0288d1","#0277bd","#01579b","#80d8ff","#40c4ff","#00b0ff","#0091ea","#84ffff","#18ffff","#00e5ff","#00b8d4","#a7ffeb","#64ffda","#1de9b6","#00bfa5","#4caf50","#a5d6a7","#81c784","#66bb6a","#4caf50","#43a047","#388e3c","#b9f6ca","#69f0ae","#00e676","#00c853","#8bc34a","#c5e1a5","#aed581","#9ccc65","#8bc34a","#7cb342","#689f38","#ccff90","#b2ff59","#76ff03","#64dd17","#cddc39","#e6ee9c","#dce775","#d4e157","#cddc39","#c0ca33","#afb42b","#9e9d24","#f4ff81","#eeff41","#c6ff00","#aeea00","#ffeb3b","#fff59d","#fff176","#ffee58","#ffeb3b","#fdd835","#fbc02d","#f9a825","#f57f17","#ffea00","#ffd600","#ffc107","#ffe082","#ffd54f","#ffca28","#ffc107","#ffb300","#ffa000","#ff8f00","#ff6f00","#ffe57f","#ffd740","#ffc400","#ffab00","#ff9800","#ffcc80","#ffb74d","#ffa726","#ff9800","#fb8c00","#f57c00","#ef6c00","#e65100","#ffd180","#ffab40","#ff9100","#ff6d00","#ff5722","#ffab91","#ff8a65","#ff7043","#ff5722","#f4511e","#e64a19","#ff9e80","#ff6e40","#ff3d00","#dd2c00"],alphabet:["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"]};GameEntity.prototype.getX=function(){return this._x},GameEntity.prototype.setX=function(e,t){this._x=e,this._needRepaint.x=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getY=function(){return this._y},GameEntity.prototype.setY=function(e,t){this._y=e,this._needRepaint.y=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getWidth=function(){return this._width},GameEntity.prototype.setWidth=function(e,t){this._width=e,this._needRepaint.width=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getHeight=function(){return this._height},GameEntity.prototype.setHeight=function(e,t){this._height=e,this._needRepaint.height=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getDX=function(){return this._dx},GameEntity.prototype.setDX=function(e){this._dx=e},GameEntity.prototype.getDY=function(){return this._dy},GameEntity.prototype.setDY=function(e){this._dy=e},GameEntity.prototype.getAngle=function(){
return this._angle},GameEntity.prototype.setAngle=function(e,t){e>=360?e-=360:-360>=e&&(e+=360),this._angle=e,this._needRepaint.angle=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getDAngle=function(){return this._dAngle},GameEntity.prototype.setDAngle=function(e){this._dAngle=e},GameEntity.prototype.getDScale=function(){return this._dScale},GameEntity.prototype.setDScale=function(e){this._dScale=e},GameEntity.prototype.getScale=function(){return this._scale},GameEntity.prototype.setScale=function(e,t){this._scale=e,this._needRepaint.scale=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getDOMElement=function(){return this._DOMElement},GameEntity.prototype.getParentDOMElement=function(){return this._parentDOMElement},GameEntity.prototype.getColor=function(){return this._color},GameEntity.prototype.setColor=function(e,t){this._color=e,this._needRepaint.color=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getBoxShadow=function(){return this._boxShadow},GameEntity.prototype.setBoxShadow=function(e,t){this._boxShadow=e,this._needRepaint.boxShadow=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getTranslateX=function(){return this._translateX},GameEntity.prototype.setTranslateX=function(e,t){this._translateX=e,this._needRepaint.translateX=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getTranslateY=function(){return this._translateY},GameEntity.prototype.setTranslateY=function(e,t){this._translateY=e,this._needRepaint.translateY=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.getTextContent=function(){return this._textContent},GameEntity.prototype.setTextContent=function(e,t){this._textContent=e,this._needRepaint.textContent=void 0===t?!0:t,this._smthChanged=!0},GameEntity.prototype.makeHidden=function(e){e?(this._visibility="hidden",this._needRepaint.visibility=!0):(this._display="none",this._needRepaint.display=!0),this._smthChanged=!0},GameEntity.prototype.makeVisible=function(){"hidden"===this._visibility?(this._visibility="visible",this._needRepaint.visibility=!0):(this._display="block",this._needRepaint.display=!0),this._smthChanged=!0},GameEntity.prototype.isVisible=function(){return"none"!==this._display&&"hidden"!==this._visibility},GameEntity.prototype.appendToParentDOMElement=function(){this._appendedToParentDOMElement||(this._parentDOMElement.appendChild(this._DOMElement),this._appendedToParentDOMElement=!0)},GameEntity.prototype.removeFromParentDOMElement=function(){this._appendedToParentDOMElement&&(this._parentDOMElement.removeChild(this._DOMElement),this._appendedToParentDOMElement=!1)},GameEntity.prototype.isAppendedToParentDOMElement=function(){return this._appendedToParentDOMElement},GameEntity.prototype.checkIfTouches=function(e){function t(e){return[[e.getX(),e.getX()+e.getWidth()],[e.getY(),e.getY()+e.getHeight()]]}function i(e,t){var i=e[0]<t[0]?e:t,s=e[0]<t[0]?t:e;return i[1]>s[0]||i[0]===s[0]}var s=!1;if(e instanceof GameEntity){var n=t(this),a=t(e);s=i(n[0],a[0])&&i(n[1],a[1])}return s},GameEntity.prototype.repaint=function(){this._appendedToParentDOMElement&&this._smthChanged&&(this._needRepaint.x&&(this._DOMElement.style.left="{x}px".replace("{x}",this._x),this._needRepaint.x=!1),this._needRepaint.y&&(this._DOMElement.style.bottom="{y}px".replace("{y}",this._y),this._needRepaint.y=!1),this._needRepaint.width&&(this._DOMElement.style.width="{width}px".replace("{width}",this._width),this._needRepaint.width=!1),this._needRepaint.height&&(this._DOMElement.style.height="{height}px".replace("{height}",this._height),this._needRepaint.height=!1),(this._needRepaint.angle||this._needRepaint.translateX||this._needRepaint.translateY||this._scale)&&(this._DOMElement.style.transform="rotate({angle}deg) scale({scale}) translate3d({x}px, {y}px, 0)".replace("{angle}",this._angle).replace("{scale}",this._scale).replace("{x}",this._translateX).replace("{y}",this._translateY),this._needRepaint.angle=!1,this._needRepaint.translateX=!1,this._needRepaint.translateY=!1),this._needRepaint.color&&(this._DOMElement.style.color="{color}".replace("{color}",this._color),this._needRepaint.color=!1),this._needRepaint.boxShadow&&(this._DOMElement.style.boxShadow="{box-shadow}".replace("{box-shadow}",this._boxShadow),this._needRepaint.boxShadow=!1),this._needRepaint.display&&(this._DOMElement.style.display="{display}".replace("{display}",this._display),this._needRepaint.display=!1),this._needRepaint.visibility&&(this._DOMElement.style.visibility="{visibility}".replace("{visibility}",this._visibility),this._needRepaint.visibility=!1),this._needRepaint.textContent&&(this._DOMElement.innerHTML=this._textContent,this._needRepaint.textContent=!1),this._smthChanged=!1)},GameField.prototype=Object.create(GameEntity.prototype),GameField.prototype.getGameFieldBackground=function(){return this._gameFieldBackground},GameField.prototype.getGameFieldTower=function(){return this._gameFieldTower},GameField.prototype.getGameFieldMenu=function(){return this._gameFieldMenu},GameField.prototype.getGameFieldTouch=function(){return this._gameFieldTouch},GameField.prototype.getGameFieldScore=function(){return this._gameFieldScore},GameField.prototype.repaint=function(){GameEntity.prototype.repaint.call(this),this._gameFieldBackground.repaint(),this._gameFieldTower.repaint(),this._gameFieldMenu.repaint(),this._gameFieldTouch.repaint(),this._gameFieldScore.repaint()},GameFieldBackground.prototype=Object.create(GameEntity.prototype),GameFieldBackground.prototype.getGameFieldBackgroundSkyLayer=function(){return this._gameFieldBackgroundSkyLayer},GameFieldBackground.prototype.getGameFieldBackgroundStarsLayer=function(){return this._gameFieldBackgroundStarsLayer},GameFieldBackground.prototype.getGameFieldBackgroundCloudsLayer=function(){return this._gameFieldBackgroundCloudsLayer},GameFieldBackground.prototype.getGameFieldBackgroundTowerLayer=function(){return this._gameFieldBackgroundTowerLayer},GameFieldBackground.prototype.getGameFieldBackgroundFPSLayer=function(){return this._gameFieldBackgroundFPSLayer},GameFieldBackground.prototype.getGameFieldBackgroundRemoteLayer=function(){return this._gameFieldBackgroundRemoteLayer},GameFieldBackground.prototype.repaint=function(){GameEntity.prototype.repaint.call(this),this._gameFieldBackgroundSkyLayer.repaint(),this._gameFieldBackgroundStarsLayer.repaint(),this._gameFieldBackgroundCloudsLayer.repaint(),this._gameFieldBackgroundTowerLayer.repaint(),this._gameFieldBackgroundFPSLayer.repaint(),this._gameFieldBackgroundRemoteLayer.repaint()},GameFieldLayer.prototype=Object.create(GameEntity.prototype),GameFieldLayer.prototype.move=function(){this.getDX()>0&&this.getTranslateX()>=0?this.setTranslateX(-this.getWidth()+window.innerWidth):this.getDX()<0&&this.getTranslateX()+this.getWidth()<=window.innerWidth?this.setTranslateX(0):this.setTranslateX(this.getTranslateX()+this.getDX()),this.getDY()>0&&this.getTranslateY()>=0?this.setTranslateY(-this.getHeight()+window.innerHeight):this.getDY()<0&&this.getTranslateY()+this.getHeight()<=window.innerHeight?this.setTranslateY(0):this.setTranslateY(this.getTranslateY()+this.getDY())},GameFieldMenu.prototype=Object.create(GameFieldLayer.prototype),GameFieldMenu.prototype.getGameFieldMenuGameOver=function(){return this._menuGameOver},GameFieldMenu.prototype.getGameFieldMenuGamePaused=function(){return this._menuGamePaused},GameFieldMenu.prototype.getGameFieldMenuAboutGameText=function(){return this._menuAboutGame},GameFieldMenu.prototype.getGameFieldMenuNewGameItem=function(){return this._menuItems[0]},GameFieldMenu.prototype.getGameFieldMenuResumeItem=function(){return this._menuItems[1]},GameFieldMenu.prototype.getGameFieldMenuMusicOnOffItem=function(){return this._menuItems[2]},GameFieldMenu.prototype.getGameFieldMenuSoundOnOffItem=function(){return this._menuItems[3]},GameFieldMenu.prototype.getGameFieldMenuFacebookItem=function(){return this._menuItems[4]},GameFieldMenu.prototype.getGameFieldMenuAboutGameItem=function(){return this._menuItems[5]},GameFieldMenu.prototype.getGameFieldMenuConnectComputerItem=function(){return this._menuItems[6]},GameFieldMenu.prototype.getGameFieldMenuRemoteControlItem=function(){return this._menuItems[7]},GameFieldMenu.prototype.getGameFieldMenuBackToMenuItem=function(){return this._menuItems[8]},GameFieldMenu.prototype.repaint=function(){GameEntity.prototype.repaint.call(this),this._menuHeader.repaint(),this._menuGameOver.repaint(),this._menuGamePaused.repaint(),this._menuAboutGame.repaint(),this._menuItems.forEach(function(e){e.repaint()})},GameFieldMenuItem.prototype=Object.create(GameEntity.prototype),GameFieldMenuHeader.prototype=Object.create(GameEntity.prototype),GameFieldMenuGameInfo.prototype=Object.create(GameEntity.prototype),GameFieldMenuText.prototype=Object.create(GameEntity.prototype),GameFieldScore.prototype=Object.create(GameEntity.prototype),GameFieldScore.prototype.getLifes=function(){return this._lifes},GameFieldScore.prototype.addLifes=function(){for(var e=0;e<this._lifes;e++)this._gameFieldScoreLifesItems[e].removeFromParentDOMElement();this._gameFieldScoreLifesItems=[],this._lifes++;for(var e=0;e<this._lifes;e++)this._gameFieldScoreLifesItems.push(new GameEntity("div",this._gameFieldScoreLifes.getDOMElement(),!0,"",["game-field-score-item","game-field-score-lifes"]))},GameFieldScore.prototype.removeLifes=function(){for(var e=0;e<this._lifes;e++)this._gameFieldScoreLifesItems[e].removeFromParentDOMElement();this._gameFieldScoreLifesItems=[],this._lifes--;for(var e=0;e<this._lifes;e++)this._gameFieldScoreLifesItems.push(new GameEntity("div",this._gameFieldScoreLifes.getDOMElement(),!0,"",["game-field-score-item","game-field-score-lifes"]))},GameFieldScore.prototype.addMonsters=function(){this._monsters++,this._gameFieldScoreMonsters.setTextContent("F "+this._monsters)},GameFieldScore.prototype.getMonsters=function(){return this._monsters},GameFieldScore.prototype.repaint=function(){GameEntity.prototype.repaint.call(this),this._gameFieldScoreLifesItems.forEach(function(e){e.repaint()}),this._gameFieldScoreMonsters.repaint()},GameFieldTouch.prototype=Object.create(GameEntity.prototype),GameFieldTouch.prototype.repaint=function(){GameEntity.prototype.repaint.call(this),this._gameFieldTouchLeft.repaint(),this._gameFieldTouchSpace.repaint(),this._gameFieldTouchRight.repaint()},GameFieldTower.prototype=Object.create(GameFieldLayer.prototype),GameFieldTower.prototype.generateSteps=function(e){var t=[],i=0,s=gameConfigs.gameField.gameFieldTower.steps.numberOfLevels;e&&(i=e[e.length-1].getLevelIndex()+1,s=i+gameConfigs.gameField.gameFieldTower.steps.numberOfLevels);for(var n=i;s>n;n++)for(var a=0;5>a;a++)if((a+n)%3===0){var r=Math.floor(3*Math.random())*Math.floor(this._widthX/3);(a+1)*this._widthX+r+this._widthX>this._maxX&&(r=0);var o=gameConfigs.colors[Math.floor(Math.random()*gameConfigs.colors.length)];t.push(new Step(this._DOMElement,!1,a*this._widthX,n,this._widthX+r,this._heightY,o))}return t},GameFieldTower.prototype.generateTricksters=function(e){var t=[],i=this,s=e.length,n=Math.min(gameConfigs.gameField.gameFieldTower.tricksters.numberOfTricksters,s),a=Math.floor(s/n);return e.filter(function(e,t){return t%a===0}).forEach(function(e){var s=new Trickster(i._DOMElement,!1,gameConfigs.alphabet[Math.floor(Math.random()*gameConfigs.alphabet.length)]),n=gameConfigs.colors[Math.floor(Math.random()*gameConfigs.colors.length)];s.setColor(n),s.setDX(gameConfigs.gameField.gameFieldTower.tricksters.arrayOfDX[Math.floor(Math.random()*gameConfigs.gameField.gameFieldTower.tricksters.arrayOfDX.length)]),s.setDY(gameConfigs.gameField.gameFieldTower.tricksters.arrayOfDY[Math.floor(Math.random()*gameConfigs.gameField.gameFieldTower.tricksters.arrayOfDY.length)]),s.setDAngle(gameConfigs.gameField.gameFieldTower.tricksters.arrayOfDAngle[Math.floor(Math.random()*gameConfigs.gameField.gameFieldTower.tricksters.arrayOfDAngle.length)]),s.setLevitateDX(gameConfigs.gameField.gameFieldTower.tricksters.arrayOfLevitateDX[Math.floor(Math.random()*gameConfigs.gameField.gameFieldTower.tricksters.arrayOfLevitateDX.length)]),s.setLevitateDY(gameConfigs.gameField.gameFieldTower.tricksters.arrayOfLevitateDY[Math.floor(Math.random()*gameConfigs.gameField.gameFieldTower.tricksters.arrayOfLevitateDY.length)]),s.setDScale(gameConfigs.gameField.gameFieldTower.tricksters.dScale),s.setTargetStep(e),t.push(s)},this),t},GameFieldTower.prototype.generateMonsters=function(e){var t=[],i=this,s=e.length,n=Math.min(gameConfigs.gameField.gameFieldTower.monsters.numberOfMonsters,s),a=Math.floor(s/n);return e.filter(function(e,t){return t%a===0}).forEach(function(e){var s=new Monster(i._DOMElement,!1,"",gameConfigs.alphabet[Math.floor(Math.random()*gameConfigs.alphabet.length)]),n=gameConfigs.colors[Math.floor(Math.random()*gameConfigs.colors.length)];s.setColor(n),s.setDAngle(gameConfigs.gameField.gameFieldTower.monsters.arrayOfDAngle[Math.floor(Math.random()*gameConfigs.gameField.gameFieldTower.monsters.arrayOfDAngle.length)]),s.setTargetStep(e),t.push(s)},this),t},GameFieldTower.prototype.generateLifes=function(e){var t=[],i=this,s=e.length,n=Math.min(gameConfigs.gameField.gameFieldTower.lifes.numberOfLifes,s),a=Math.floor(s/n);return e.filter(function(e,t){return t%a===0}).forEach(function(e){var s=new Life(i._DOMElement,!1);s.setDScale(gameConfigs.gameField.gameFieldTower.lifes.dScale),s.setTargetStep(e),t.push(s)}),t},GameFieldTower.prototype.getSteps=function(){return this._steps},GameFieldTower.prototype.getTricksters=function(){return this._tricksters},GameFieldTower.prototype.getMonsters=function(){return this._monsters},GameFieldTower.prototype.getLifes=function(){return this._lifes},GameFieldTower.prototype.getVisibleSteps=function(){return this._visibleSteps},GameFieldTower.prototype.getVisibleTricksters=function(){return this._visibleTricksters},GameFieldTower.prototype.getVisibleMonsters=function(){return this._visibleMonsters},GameFieldTower.prototype.getVisibleLifes=function(){return this._visibleLifes},GameFieldTower.prototype.getGamer=function(){return this._gamer},GameFieldTower.prototype.pickUpMonster=function(e){e.removeFromParentDOMElement(),this._monsters.splice(this._monsters.indexOf(e),1),this._visibleMonsters.splice(this._visibleMonsters.indexOf(e),1);var t=e.getTargetStep();t.setTargetMonster(null)},GameFieldTower.prototype.pickUpLife=function(e){e.removeFromParentDOMElement(),this._lifes.splice(this._lifes.indexOf(e),1),this._visibleLifes.splice(this._visibleLifes.indexOf(e),1);var t=e.getTargetStep();t.setTargetLife(null)},GameFieldTower.prototype.update=function(){if(this._visibleSteps.length&&this._visibleSteps[this._visibleSteps.length-1].getLevelIndex()===this._steps[this._steps.length-1].getLevelIndex()){var e=this.generateSteps(this._steps);this._steps=this._steps.concat(e),this._tricksters=this._tricksters.concat(this.generateTricksters(e)),this._monsters=this._monsters.concat(this.generateMonsters(e)),this._lifes=this._lifes.concat(this.generateLifes(e))}var t=this;this._steps.forEach(function(e){var i=e.getTargetTrickster(),s=e.getTargetMonster(),n=e.getTargetLife();if(!e.isAppendedToParentDOMElement()&&e.getY()<=t.getHeight()&&e.getY()>=t._pixel){if(e.appendToParentDOMElement(),t._visibleSteps.push(e),i){if(i.appendToParentDOMElement(),!i.getWidth()){var a=i.getDOMElement().getBoundingClientRect();i.setWidth(a.width),i.setHeight(a.height)}t._visibleTricksters.push(i)}if(s){if(s.appendToParentDOMElement(),!s.getWidth()){var r=s.getDOMElement().getBoundingClientRect();s.setWidth(r.width),s.setHeight(r.height)}t._visibleMonsters.push(s)}if(n){if(n.appendToParentDOMElement(),!n.getWidth()){var o=n.getDOMElement().getBoundingClientRect();n.setWidth(o.width),n.setHeight(o.height)}t._visibleLifes.push(n)}}else e.isAppendedToParentDOMElement()&&(e.getY()<t._pixel||e.getY()>t.getHeight())&&(e.removeFromParentDOMElement(),t._visibleSteps.splice(t._visibleSteps.indexOf(e),1),i&&(i.removeFromParentDOMElement(),t._visibleTricksters.splice(t._visibleTricksters.indexOf(i),1)),s&&(s.removeFromParentDOMElement(),t._visibleMonsters.splice(t._visibleMonsters.indexOf(s),1)),n&&(n.removeFromParentDOMElement(),t._visibleLifes.splice(t._visibleLifes.indexOf(n),1)))})},GameFieldTower.prototype.repaint=function(){GameFieldLayer.prototype.repaint.call(this),this._visibleSteps.forEach(function(e){e.repaint();var t=e.getTargetTrickster();t&&t.repaint();var i=e.getTargetMonster();i&&i.repaint();var s=e.getTargetLife();s&&s.repaint()})},GameFieldTower.prototype.addPixel=function(e){this._pixel+=e,this.setHeight(this.getHeight()+e),this.update()},GameFieldTower.prototype.minusPixel=function(e){this._pixel-=e,this.setHeight(this.getHeight()-e),this.update()},GameFieldTower.prototype.getPixel=function(){return this._pixel},Gamer.prototype=Object.create(GameEntity.prototype),Gamer.prototype.setID=function(e){this._id=e},Gamer.prototype.getID=function(){return this._id},Gamer.prototype.setTargetStep=function(e){this._targetStep=e,this.setY(this._targetStep.getY()+this._targetStep.getHeight())},Gamer.prototype.getTargetStep=function(){return this._targetStep},Gamer.prototype.setDDY=function(e){this._ddy=e},Gamer.prototype.getDDY=function(){return this._ddy},Gamer.prototype.getIsFalling=function(){return this._isFalling},Gamer.prototype.getIsJumping=function(){return this._isJumping},Gamer.prototype.getNearestBottomTargetStep=function(){var e=this,t=null,i=!0;return this._gameFieldTower.getVisibleSteps().filter(function(t){return t.getY()<=e.getY()}).forEach(function(s){s.getX()<e.getX()+e.getWidth()&&s.getX()+s.getWidth()>e.getX()&&((i||t.getY()<s.getY())&&(t=s),i=!1)}),t},Gamer.prototype.getNearestTopTargetStep=function(){var e=this,t=null,i=!0;return this._gameFieldTower.getVisibleSteps().filter(function(t){return t.getY()>=e.getY()}).forEach(function(s){s.getX()<e.getX()+e.getWidth()&&s.getX()+s.getWidth()>e.getX()&&((i||t.getY()>s.getY())&&(t=s),i=!1)}),t},Gamer.prototype.getTouchedTrickster=function(){var e=this,t=null;return this._gameFieldTower.getVisibleTricksters().forEach(function(i){e.checkIfTouches(i)&&(t=!0)}),t!==this._lastTouchedTrickster?this._lastTouchedTrickster=t:t?t=null:this._lastTouchedTrickster=null,t},Gamer.prototype.getTouchedMonster=function(){var e=this,t=null;return this._gameFieldTower.getVisibleMonsters().forEach(function(i){e.checkIfTouches(i)&&(t=i)}),t},Gamer.prototype.getTouchedLife=function(){var e=this,t=null;return this._gameFieldTower.getVisibleLifes().forEach(function(i){e.checkIfTouches(i)&&(t=i)}),t},Gamer.prototype.moveLeft=function(){this.getAngle()<0?this.setAngle(this.getAngle()+this.getDAngle()):this.setAngle(this.getAngle()-this.getDAngle()),this.setX(this.getX()-this.getDX()),!this._isFalling&&!this._isJumping&&this.getX()-this.getDX()+this.getWidth()<this.getTargetStep().getX()&&(this._isFalling=!0)},Gamer.prototype.moveRight=function(){this.getAngle()>0?this.setAngle(this.getAngle()-this.getDAngle()):this.setAngle(this.getAngle()+this.getDAngle()),this.setX(this.getX()+this.getDX()),!this._isFalling&&!this._isJumping&&this.getX()+this.getDX()>this.getTargetStep().getX()+this.getTargetStep().getWidth()&&(this._isFalling=!0)},Gamer.prototype.standStill=function(){0!==this.getAngle()&&this.setAngle(0)},Gamer.prototype.jump=function(){var e=this.getY();this._isJumping||(this._isJumping=!0);var t=this.getNearestTopTargetStep();!t&&this._jumpingCounter>=2&&(this._isJumping=!1,this._jumpingCounter=0,this._isFalling=!0);var i=this.getDY()+this.getDDY()*this._jumpingCounter;this.setY(this.getY()+i),this._jumpingCounter++,t&&this.getY()>=t.getY()&&(this.setTargetStep(t),this._isJumping=!1,this._jumpingCounter=0);var s=Math.abs(this.getY()-e);s&&this._gameFieldTower.addPixel(s)},Gamer.prototype.fall=function(){this._isJumping=!1;var e=this.getY(),t=this.getNearestBottomTargetStep(),i=this.getDY()+this.getDDY()*this._fallingCounter;this.setY(this.getY()-i),this._fallingCounter++,t&&this.getY()<=t.getY()&&(this.setTargetStep(t),this._isFalling=!1,this._fallingCounter=0);var s=Math.abs(this.getY()-e);s&&this._gameFieldTower.minusPixel(s)},Gamer.prototype.pulse=function(){this.setScale(this.getScale()+this.getDScale()),this.getScale()>=1.05?this.setDScale(-this.getDScale()):this.getScale()<1&&this.setDScale(-this.getDScale())},Life.prototype=Object.create(GameEntity.prototype),Life.prototype.setTargetStep=function(e){this._targetStep=e,e.setTargetLife(this),this.setX(this._targetStep.getX()+Math.floor(this._targetStep.getWidth()/2)),this.setY(this._targetStep.getY()+3*this._targetStep.getHeight())},Life.prototype.getTargetStep=function(){return this._targetStep},Life.prototype.pulse=function(){this.setScale(this.getScale()+this.getDScale()),this.getScale()>1.4?this.setDScale(-this.getDScale()):this.getScale()<1&&this.setDScale(-this.getDScale())},Monster.prototype=Object.create(GameEntity.prototype),Monster.prototype.rotate=function(){this.setAngle(this.getAngle()+this.getDAngle())},Monster.prototype.setTargetStep=function(e){this._targetStep=e,e.setTargetMonster(this),this.setX(this._targetStep.getX()+Math.floor(this._targetStep.getWidth()/2)),this.setY(this._targetStep.getY()+3*this._targetStep.getHeight())},Monster.prototype.getTargetStep=function(){return this._targetStep},Step.prototype=Object.create(GameEntity.prototype),Step.prototype.getLevelIndex=function(){return this._levelIndex},Step.prototype.setTargetMonster=function(e){this._targetMonster=e},Step.prototype.getTargetMonster=function(){return this._targetMonster},Step.prototype.setTargetTrickster=function(e){this._targetTrickster=e},Step.prototype.getTargetTrickster=function(){return this._targetTrickster},Step.prototype.setTargetLife=function(e){this._targetLife=e},Step.prototype.getTargetLife=function(){return this._targetLife},Step.prototype.repaint=function(){GameEntity.prototype.repaint.call(this)},Trickster.prototype=Object.create(GameEntity.prototype),Trickster.prototype.setLevitateDX=function(e){this._levitateDX=e},Trickster.prototype.getLevitateDX=function(){return this._levitateDX},Trickster.prototype.setLevitateDY=function(e){this._levitateDY=e},Trickster.prototype.getLevitateDY=function(){return this._levitateDY},Trickster.prototype.levitate=function(){this._preLevitateX||(this._preLevitateX=this.getX()),this._preLevitateY||(this._preLevitateY=this.getY()),this.getDX()>=0?this.getX()+this.getDX()<=this._preLevitateX+this._levitateDX?this.setX(this.getX()+this.getDX()):this.setDX(-1*this.getDX()):this.getX()+this.getDX()>=this._preLevitateX-this._levitateDX?this.setX(this.getX()+this.getDX()):this.setDX(-1*this.getDX()),this.getDY()>=0?this.getY()+this.getDY()<=this._preLevitateY+this._levitateDY?this.setY(this.getY()+this.getDY()):this.setDY(-1*this.getDY()):this.getY()+this.getDY()>=this._preLevitateY-this._levitateDY?this.setY(this.getY()+this.getDY()):this.setDY(-1*this.getDY())},Trickster.prototype.rotate=function(){this.setAngle(this.getAngle()+this.getDAngle())},Trickster.prototype.pulse=function(){this.setScale(this.getScale()+this.getDScale()),this.getScale()>=1.1?this.setDScale(-this.getDScale()):this.getScale()<1&&this.setDScale(-this.getDScale())},Trickster.prototype.setTargetStep=function(e){this._targetStep=e,e.setTargetTrickster(this),this.setX(this._targetStep.getX()),this.setY(this._targetStep.getY()+3*this._targetStep.getHeight())},Trickster.prototype.getTargetStep=function(){return this._targetStep},document.getElementById("body").focus();var gameWrapper=document.getElementById("game-wrapper"),game=new Game(gameWrapper);document.addEventListener("keydown",game.keyDownEventHandler.bind(game),!1),document.addEventListener("keyup",game.keyUpEventHandler.bind(game),!1),document.addEventListener("click",game.mouseClickEventHandler.bind(game),!1),document.addEventListener("touchstart",game.touchStartEventHandler.bind(game),!1),document.addEventListener("touchend",game.touchEndEventHandler.bind(game),!1),window.addEventListener("resize",debounce(game.resizeEventHandler.bind(game),100),!1),game.start();